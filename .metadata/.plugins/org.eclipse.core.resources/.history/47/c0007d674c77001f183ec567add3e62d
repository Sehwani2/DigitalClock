/*
 * buzzer.c
 *
 *  Created on: Sep 17, 2024
 *      Author: hyn02
 */

#include "buzzer.h"

 Buz Buz1;

void activateBuzzer30msOn( Buz* buzzer, TIM_HandleTypeDef* htim, uint32_t channel,uint32_t psc)
{
	if(buzzer->BuzOnOff)
	{
		__HAL_TIM_SET_PRESCALER(htim, psc);
		HAL_TIM_PWM_Start(htim, channel);
		buzzer->BuzCount = 0;
	}

}

void activateBuzzer30msOff( Buz* buzzer, TIM_HandleTypeDef* htim, uint32_t channel)
{
	if (buzzer->BuzOnOff)
	{
		buzzer->BuzCount++;
		HAL_GPIO_TogglePin(GPIOD, GPIO_PIN_12);
		printf("buzzer count : %d \n buzzeronoff : %d\n"
				,buzzer->BuzCount,buzzer->BuzOnOff);

		if (buzzer->BuzCount >= 30)
		{
			buzzer->BuzOnOff = 0;
			HAL_TIM_PWM_Stop(htim, channel);
			buzzer->BuzCount = 0;
		}
	}
}
